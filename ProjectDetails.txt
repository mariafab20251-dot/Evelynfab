Complete Video Automation System - Comprehensive Summary
ğŸ“‹ Project Overview
A fully automated system that processes videos with text overlays and uploads them to multiple YouTube channels with smart scheduling and Google Sheets tracking.

ğŸ—ï¸ System Architecture
Three-Part Automation Pipeline:
Part 1: Video Overlay Design & Processing
â”œâ”€ GUI for visual overlay customization
â”œâ”€ Automated video processing with quotes
â””â”€ Output: Branded videos ready for upload

Part 2: Multi-Channel YouTube Upload
â”œâ”€ Automated upload to 5 channels
â”œâ”€ Smart scheduling (20-30 min gaps per channel)
â”œâ”€ Independent channel tracking
â””â”€ Archive system after all uploads

Part 3: Google Sheets Tracking
â”œâ”€ Real-time upload logging
â”œâ”€ Status tracking per video
â”œâ”€ Error logging
â””â”€ Schedule time tracking
```

---

## ğŸ“ Complete Folder Structure
```
D:\MyFinalAutomations\ScriptAutomations\

VideoFolder\
â”œâ”€â”€ Hamood Alhaqab\              â† Raw input videos
â”œâ”€â”€ Quotes.txt                   â† Quote library (one per line)
â”œâ”€â”€ FinalVideos\                 â† Processed videos (ready to upload)
â””â”€â”€ uploadeHamoodAlhaqab\        â† Archive (after all 5 channels uploaded)

YoutubeUploadSetup\
â”œâ”€â”€ youtube_uploader.py          â† Main upload script
â”œâ”€â”€ overlay_settings_gui.py      â† Design GUI (in parent folder)
â”œâ”€â”€ youtube_video_automation.py  â† Video processor (in parent folder)
â”œâ”€â”€ overlay_settings.json        â† Saved design settings
â”œâ”€â”€ youtube_credentials\
â”‚   â”œâ”€â”€ client_secret_channel1 Jubal.json
â”‚   â”œâ”€â”€ client_secret_channel2 MasterChef.json
â”‚   â”œâ”€â”€ client_secret_channel3 Starry.json
â”‚   â”œâ”€â”€ client_secret_channel4 Kiki.json
â”‚   â”œâ”€â”€ client_secret_channel5 MasterChef.json
â”‚   â””â”€â”€ service_account.json     â† For Google Sheets
â””â”€â”€ BatFiles\
    â”œâ”€â”€ setup_youtube.bat
    â”œâ”€â”€ start_uploader.bat
    â”œâ”€â”€ upload_one_video.bat
    â””â”€â”€ check_upload_stats.bat

ğŸ¨ Part 1: Video Overlay System
Features:

âœ… Visual GUI with live preview
âœ… Auto-detect all system fonts (100+)
âœ… Separate customization for main text, emoji, and CTA
âœ… Toggle buttons to enable/disable emoji and CTA
âœ… Full font path saving (fixes font rendering issues)
âœ… Multiple bubble sections with rounded corners
âœ… Automatic word wrapping
âœ… Compatible with MoviePy 2.x

Configuration:
pythonSettings saved in: overlay_settings.json

Key settings:
- font_size: 30-80
- font_style: Any system font
- font_file: Full path to .ttf file (auto-saved)
- text_color, bg_color, bg_opacity
- cta_enabled, emoji_enabled
- cta_font_size, cta_font_style, cta_font_file
- bubble_width, padding, spacing, corner_radius
- position: top/center/bottom
Usage:
bash# Design overlay
run_gui.bat
â†’ Adjust settings
â†’ Click "ğŸ’¾ Save Settings"

# Process videos
process_videos.bat
â†’ Reads Hamood Alhaqab folder
â†’ Applies overlay with quotes
â†’ Outputs to FinalVideos
```

### **Quote Format:**
```
Quotes.txt supports multiple formats:
1. Numbered: "1. Quote text"
2. Double newline separated
3. Triple dash separated (---)
4. One per line

Quote structure parsed automatically:
- Main text
- Emojis (detected and separated)
- CTA (questions like "Agree?", "True?")
```

---

## ğŸ“º Part 2: YouTube Upload System

### **Features:**
- âœ… Upload to 5 channels automatically
- âœ… Videos uploaded as PRIVATE with scheduled publish
- âœ… Smart scheduling: 20-30 min gaps per channel
- âœ… Independent channel tracking (each channel remembers its own last time)
- âœ… Automatic archiving after all 5 channels succeed
- âœ… Error handling with retry capability
- âœ… Title/tags extraction from filename
- âœ… Auto-generated descriptions

### **Channels Configured:**
```
1. Jubal         (client_secret_channel1 Jubal.json)
2. MasterChef    (client_secret_channel2 MasterChef.json)
3. Starry        (client_secret_channel3 Starry.json)
4. Kiki          (client_secret_channel4 Kiki.json)
5. Nadia         (client_secret_channel5 MasterChef.json)
```

### **Upload Flow:**
```
1. Pick oldest video from FinalVideos\
2. For each channel (1-5):
   â”œâ”€ Get channel's last scheduled time from sheet
   â”œâ”€ Calculate next time (+20-30 min random)
   â”œâ”€ Upload as PRIVATE
   â”œâ”€ Set scheduled publish time
   â”œâ”€ Update Google Sheet
   â””â”€ Wait 5 minutes
3. If ALL uploads successful:
   â””â”€ Move video to uploadeHamoodAlhaqab\
4. If ANY upload fails:
   â””â”€ Keep video in FinalVideos\ for retry
Scheduling Algorithm:
pythonFirst video per channel:
- Schedule: Now + 1 hour

Subsequent videos per channel:
- Get last_scheduled_time from THIS channel's sheet
- Add: 20-30 minutes (random)
- Add: Â±5 minutes variation
- Ensure: Time is in future

Format: 01-Nov-2025 10:09 AM
```

### **Example Schedule:**
```
Video 1 (uploaded 10:00 AM):
â”œâ”€ Jubal:      11:00 AM (first, +1 hour)
â”œâ”€ MasterChef: 11:05 AM (first, +1 hour)
â”œâ”€ Starry:     11:10 AM (first, +1 hour)
â”œâ”€ Kiki:       11:15 AM (first, +1 hour)
â””â”€ Nadia:      11:20 AM (first, +1 hour)

Video 2 (uploaded 10:30 AM):
â”œâ”€ Jubal:      11:25 AM (11:00 + 25m)
â”œâ”€ MasterChef: 11:32 AM (11:05 + 27m)
â”œâ”€ Starry:     11:33 AM (11:10 + 23m)
â”œâ”€ Kiki:       11:43 AM (11:15 + 28m)
â””â”€ Nadia:      11:46 AM (11:20 + 26m)

Each channel tracks independently!
```

---

## ğŸ“Š Part 3: Google Sheets Integration

### **Spreadsheet:**
```
URL: https://docs.google.com/spreadsheets/d/13fKTGkDchTE2-JY3Bgr79pRKBxxHW4yEdbSJ8rzNzsQ/edit
Name: PyAutomation

Tabs (one per channel):
- Jubal
- MasterChef
- Starry
- Kiki
- Nadia
```

### **Columns (A-H):**
```
A: video_title     - Extracted from filename
B: description     - Auto-generated
C: video_url       - https://youtube.com/watch?v=...
D: youtube_id      - Video ID
E: upload_time     - When uploaded (01-Nov-2025 10:09 AM)
F: schedual_time   - When goes public (01-Nov-2025 11:35 AM)
G: status          - "done" or "error"
H: error           - Error message if failed
Tracking Logic:

Each upload appends a new row to corresponding channel's sheet
Status marked "done" on success
Error logged in error column on failure
Next schedule calculated from last row in that channel's sheet


ğŸ”§ Installed Packages
bash# Video processing
pip install moviepy pillow numpy

# YouTube upload
pip install google-auth google-auth-oauthlib google-auth-httplib2 google-api-python-client

# Google Sheets
pip install gspread
```

---

## ğŸ¯ Daily Workflow

### **Morning (15 minutes):**
```
1. Create/update Quotes.txt
2. Add raw videos to Hamood Alhaqab folder
3. Run: run_gui.bat (optional - if changing style)
4. Run: process_videos.bat
5. Videos now in FinalVideos folder
```

### **Afternoon (2 minutes to start):**
```
1. cd D:\MyFinalAutomations\ScriptAutomations\YoutubeUploadSetup
2. python youtube_uploader.py
3. Choose: 2 (Continuous mode)
4. System runs automatically:
   - Uploads to all 5 channels
   - Updates Google Sheets
   - Moves to archive
   - Picks next video
   - Waits 30 minutes
   - Repeats
```

### **Evening (5 minutes):**
```
1. Check Google Sheets for statistics
2. Verify no errors
3. Check YouTube Studio for performance
```

---

## ğŸš€ Current Status & Achievements

### âœ… **Working:**
- Video overlay GUI with full customization
- Font detection and loading (100+ system fonts)
- Video processing with quotes
- Multi-channel upload rotation
- Independent channel scheduling
- YouTube API integration
- Automatic archiving system
- Error handling

### âš ï¸ **Current Issue:**

**Google Sheets Authentication Error:**
```
APIError: [403]: Request had insufficient authentication scopes.
```

**What's happening:**
- Videos upload to YouTube successfully âœ“
- Scheduling works âœ“
- BUT: Cannot update Google Sheets âœ—

**Likely cause:**
- Service account credentials not set up
- OR wrong OAuth scopes
- OR spreadsheet not shared with service account

---

## ğŸ” Authentication Setup

### **YouTube (Working):**
```
5 OAuth credentials configured:
- client_secret_channel1 Jubal.json
- client_secret_channel2 MasterChef.json
- client_secret_channel3 Starry.json
- client_secret_channel4 Kiki.json
- client_secret_channel5 MasterChef.json

Tokens generated on first run:
- token_channel1_jubal.pickle
- token_channel2_masterchef.pickle
- token_channel3_starry.pickle
- token_channel4_kiki.pickle
- token_channel5_nadia.pickle
```

### **Google Sheets (Needs Fix):**
```
Current file: service_account.json (in youtube_credentials folder)

Required:
1. Service account with Sheets API access
2. Spreadsheet shared with service account email
3. Correct scopes in credentials

ğŸ› ï¸ Code Components
Main Scripts:

overlay_settings_gui.py (Video overlay design)

Tkinter GUI
Font scanning from C:\Windows\Fonts
Live preview with PIL
Settings saved to overlay_settings.json


youtube_video_automation.py (Video processing)

MoviePy 2.x compatible
Reads overlay_settings.json
Processes videos with PIL overlays
Outputs to FinalVideos folder


youtube_uploader.py (YouTube upload & tracking)

YouTube Data API v3
Google Sheets API (gspread)
Independent channel scheduling
Automatic archiving



Key Functions:
python# Scheduling
get_last_scheduled_time(channel_id)
â†’ Reads from specific channel's sheet
â†’ Returns last scheduled datetime for THAT channel

calculate_next_schedule_time(channel_id)
â†’ Adds 20-30 min to channel's last time
â†’ Returns future datetime

# Upload
upload_video(video_path, channel_id)
â†’ Uploads as PRIVATE
â†’ Sets scheduled publish time
â†’ Updates Google Sheet

upload_to_all_channels(video_path)
â†’ Loops through all 5 channels
â†’ Moves video if all succeed
â†’ Keeps video if any fail

# Sheets
update_sheet(channel_id, video_title, video_id, ...)
â†’ Appends row to channel's sheet
â†’ Format: 01-Nov-2025 10:09 AM
```

---

## ğŸ“ˆ Performance Metrics

### **Per Video:**
```
Processing time: 5-10 minutes (depends on video length)
Upload time: 25 minutes (5 channels Ã— 5 min)
Total automation time: 30-35 minutes per video
```

### **Daily Capacity:**
```
Videos processed: 20-30 per day (manual start)
Total uploads: 100-150 (20-30 Ã— 5 channels)
Hands-on time: ~20 minutes per day
Automated time: ~10-15 hours (system runs itself)
```

### **Schedule Distribution:**
```
20 videos uploaded:
- Each channel: 20 videos scheduled
- Time span: ~8-10 hours of content per channel
- Total: 100 scheduled videos across 5 channels

ğŸ“ How to Scale (Add More Channels)
Steps to add 5 more channels (10 total):

Google Cloud Setup (per new channel):

Create project
Enable YouTube Data API v3
Create OAuth credentials
Download JSON
Rename: client_secret_channel6.json (etc.)
Place in youtube_credentials folder


Google Sheets Setup:

Add new tabs: Channel6, Channel7, etc.
Copy headers from existing tabs


Update youtube_uploader.py:

python   'channel6': {
       'name': 'Channel 6 Name',
       'sheet_name': 'Channel6',
       'credentials_file': 'client_secret_channel6.json',
       'token_file': 'token_channel6.pickle',
       'default_category': '22',
       'default_privacy': 'private'
   }

Adjust timing (optional):

python   self.upload_interval = 3 * 60  # 3 min for 10 channels
System automatically handles any number of channels!

ğŸ”§ Configuration Files
overlay_settings.json:
json{
  "font_size": 45,
  "font_style": "Consola Italic",
  "font_file": "C:\\Windows\\Fonts\\consolai.ttf",
  "text_color": "#000000",
  "bg_color": "#FFFFFF",
  "bg_opacity": 90,
  "cta_enabled": true,
  "cta_font_size": 43,
  "cta_font_style": "Arial Italic",
  "cta_font_file": "C:\\Windows\\Fonts\\ariali.ttf",
  "emoji_enabled": true,
  "emoji_size_multiplier": 1.2,
  "bubble_width": 75,
  "padding_horizontal": 40,
  "padding_vertical": 20,
  "inner_padding": 15,
  "section_spacing": 15,
  "corner_radius": 15,
  "position": "top"
}

ğŸ› Known Issues & Solutions
Issue 1: Font not rendering correctly
Status: âœ… FIXED
Solution: Save full font file paths in overlay_settings.json
Issue 2: Google Sheets not updating
Status: âš ï¸ CURRENT ISSUE
Error: [403]: Request had insufficient authentication scopes
Next steps: Fix service account scopes or use OAuth for Sheets
Issue 3: Videos not moving to archive
Status: âœ… Working by design
Behavior: Videos only move after ALL 5 channels upload successfully

ğŸ’¡ Design Decisions
Why independent channel scheduling?

Each channel builds its own natural timeline
No bunching of uploads at same times
Looks organic to YouTube algorithm
Easy to scale to more channels

Why 20-30 minute gaps?

Allows ~2-3 hours between batches
When system runs continuously, creates perfect distribution
Not too close (looks bot-like)
Not too far (allows multiple videos per day)

Why archive only after all channels?

Prevents duplicate uploads
Easy error recovery
Ensures every video on every channel
Clean separation of processed/unprocessed

Why Google Sheets tracking?

Real-time visibility
Easy analytics and exports
Shared team access
No database setup needed


ğŸ“ Quick Commands Reference
bash# Video Processing
cd D:\MyFinalAutomations\ScriptAutomations
python overlay_settings_gui.py        # Design overlays
python youtube_video_automation.py     # Process videos

# YouTube Upload
cd YoutubeUploadSetup
python youtube_uploader.py
  1 = Test upload (one video to all channels)
  2 = Continuous mode (production)
  3 = Show statistics
  4 = Exit

# Batch Files
BatFiles\setup_youtube.bat            # Install packages
BatFiles\start_uploader.bat           # Start uploader
BatFiles\upload_one_video.bat         # Test upload
BatFiles\check_upload_stats.bat       # View stats
BatFiles\reset_authentication.bat     # Reset tokens

ğŸ¯ Next Steps / To-Do

FIX: Google Sheets authentication (scope issue)
TEST: Full workflow with Sheets working
OPTIMIZE: Batch wait time between videos
ENHANCE: Add thumbnail generation
SCALE: Add 5 more channels (if needed)
MONITOR: Track performance metrics
AUTOMATE: Schedule daily runs via Task Scheduler


âœ… Summary
System Status: 95% Complete

Video processing: âœ… 100% working
YouTube upload: âœ… 100% working
Scheduling: âœ… 100% working
Google Sheets: âš ï¸ 95% working (auth issue)

Current Focus: Fix Google Sheets API authentication
Once Fixed: Fully automated end-to-end pipeline from video creation â†’ upload â†’ tracking â†’ archiving
